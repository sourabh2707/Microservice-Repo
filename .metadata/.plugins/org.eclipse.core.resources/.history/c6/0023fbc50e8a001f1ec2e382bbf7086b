package com.hotel.services;

import java.util.List;
import java.util.UUID;
import java.util.stream.Collectors;

import org.modelmapper.ModelMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.hotel.entities.Hotels;
import com.hotel.entities.Staffs;
import com.hotel.exceptions.ResourceNotFoundException;
import com.hotel.payloads.StaffDTO;
import com.hotel.repositories.HotelRepository;
import com.hotel.repositories.StaffRepository;

@Service
public class StaffServiceImpl implements StaffService {

	@Autowired
	private StaffRepository staffRepository;
	
	@Autowired
	private HotelRepository hotelRepository;
	
	  @Autowired private ModelMapper modelMapper;
	 

	@Override
	public Staffs create(String hotelId, Staffs staffs) {
		String id = UUID.randomUUID().toString();
		staffs.setStaffId(id);
		Hotels hotels = hotelRepository.findById(hotelId).orElseThrow(()->new ResourceNotFoundException(String.format("Hotel id : %s not found on server", hotelId)));
		staffs.setHotels(hotels);
		return staffRepository.save(staffs);
	}

	@Override
	public Staffs update(Staffs staffs) {
		Staffs staffs1 = staffRepository.findById(staffs.getStaffId()).orElseThrow(() -> new ResourceNotFoundException(
				String.format("Resource with user id %s not found on server", staffs.getStaffId())));
		staffs1.setName(staffs.getName());
		staffs1.setHotels(staffs.getHotels());
		
		return staffRepository.save(staffs1);
	}

	@Override
	public List<Staffs> get(String hotelId) {
		List<Staffs> list = staffRepository.findByHotelId(hotelId);
		StaffDTO staffDTO = new StaffDTO();
		 list.stream().map(i->modelMapper.map(i, staffDTO)).collect(Collectors.toList());
		return null;
	}

	@Override
	public List<Staffs> getAll() {
		
		return staffRepository.findAll();
	}

	@Override
	public void delete(String staffId) {
		staffRepository.deleteById(staffId); 
	}

}
